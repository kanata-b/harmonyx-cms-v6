# HarmonyX CMS v6 API Testing
# Use REST Client extension to test these APIs

### Variables
@kong_host = http://localhost:8000
@kong_admin = http://localhost:8001
@directus_host = http://localhost:8055
@nextjs_host = http://localhost:3000

### Kong API Gateway Tests

# Test Next.js through Kong (Root)
GET {{kong_host}}/
Accept: text/html

###

# Test Next.js through Kong (Frontend path)
GET {{kong_host}}/frontend/
Accept: text/html

###

# Test Directus Admin through Kong
GET {{kong_host}}/cms/admin
Accept: text/html

###

# Test Directus API through Kong (Health check)
GET {{kong_host}}/cms/server/health
Accept: application/json

###

### Kong Admin API Tests

# List all services
GET {{kong_admin}}/services
Accept: application/json

###

# List all routes
GET {{kong_admin}}/routes
Accept: application/json

###

# List all plugins
GET {{kong_admin}}/plugins
Accept: application/json

###

# Kong Status
GET {{kong_admin}}/status
Accept: application/json

###

### Direct Service Tests (Bypass Kong)

# Test Next.js directly
GET {{nextjs_host}}/
Accept: text/html

###

# Test Directus directly
GET {{directus_host}}/server/health
Accept: application/json

###

# Test Directus Admin directly
GET {{directus_host}}/admin
Accept: text/html

###

### Directus API Tests through Kong

# Get Collections (requires auth)
GET {{kong_host}}/cms/collections
Accept: application/json
Authorization: Bearer YOUR_TOKEN_HERE

###

# Get Posts (example collection - adjust as needed)
GET {{kong_host}}/cms/items/posts
Accept: application/json

###

# Get Posts with public token
GET {{kong_host}}/cms/items/posts?access_token=FeY242X8yeTy8DOvsz3jRpKfy9raEfMf
Accept: application/json

###

### Health Checks

# Kong Health
GET {{kong_host}}/
Accept: text/html

###

# Directus Health through Kong
GET {{kong_host}}/cms/server/health
Accept: application/json

###

# Next.js Health through Kong
GET {{kong_host}}/
Accept: text/html

###

### Create New Route via Kong Admin API (Example)

# Create new service
POST {{kong_admin}}/services
Content-Type: application/json

{
  "name": "example-service",
  "url": "http://httpbin.org"
}

###

# Create route for the service (replace service-id)
POST {{kong_admin}}/services/example-service/routes
Content-Type: application/json

{
  "name": "example-route",
  "paths": ["/httpbin"],
  "strip_path": true
}

###
